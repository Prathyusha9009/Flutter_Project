import 'package:flutter/material.dart';

void main() => runApp(MindNestApp());

class MindNestApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'MindNest â€” Grow, Recall, Test',
      debugShowCheckedModeBanner: false,
      theme: ThemeData(
        fontFamily: 'Arial',
        scaffoldBackgroundColor: Colors.teal.shade50,
        appBarTheme: AppBarTheme(
          backgroundColor: Colors.teal.shade400,
          elevation: 3,
          centerTitle: true,
          titleTextStyle: TextStyle(
            fontSize: 20,
            fontWeight: FontWeight.bold,
            color: Colors.white,
          ),
          iconTheme: IconThemeData(color: Colors.white),
        ),
        elevatedButtonTheme: ElevatedButtonThemeData(
          style: ElevatedButton.styleFrom(
            shape: StadiumBorder(),
            padding: EdgeInsets.symmetric(vertical: 14, horizontal: 20),
            textStyle: TextStyle(fontSize: 18, fontWeight: FontWeight.w600),
          ),
        ),
      ),
      home: HomeScreen(),
    );
  }
}

//////////////////// HOME ////////////////////

class HomeScreen extends StatelessWidget {
  void _navigate(BuildContext context, Widget page) {
    Navigator.push(
      context,
      PageRouteBuilder(
        pageBuilder: (_, __, ___) => page,
        transitionsBuilder: (_, anim, __, child) =>
            FadeTransition(opacity: anim, child: child),
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text("MindNest â€” Grow, Recall, Test")),
      body: Container(
        decoration: BoxDecoration(
          gradient: LinearGradient(
            colors: [Colors.teal.shade100, Colors.teal.shade50],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        child: Padding(
          padding: const EdgeInsets.all(24.0),
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              Icon(Icons.spa, size: 80, color: Colors.teal.shade600),
              SizedBox(height: 10),
              Text(
                "MindNest",
                style: TextStyle(
                    fontSize: 32,
                    color: Colors.teal.shade700,
                    fontWeight: FontWeight.bold),
              ),
              Text("Grow â€¢ Recall â€¢ Test",
                  style: TextStyle(color: Colors.grey.shade700, fontSize: 16)),
              SizedBox(height: 50),
              _menuButton(context, Icons.account_tree_rounded, "TopicTree",
                  Colors.purple.shade400, Colors.white, TopicTreeScreen()),
              SizedBox(height: 20),
              _menuButton(context, Icons.style_rounded, "FocusCards",
                  Colors.indigo.shade400, Colors.white, FocusCardsScreen()),
              SizedBox(height: 20),
              _menuButton(context, Icons.quiz_rounded, "QuizTrail",
                  Colors.pink.shade300, Colors.white, QuizTrailScreen()),
            ],
          ),
        ),
      ),
    );
  }

  Widget _menuButton(BuildContext context, IconData icon, String title,
      Color color, Color textColor, Widget page) {
    return ElevatedButton.icon(
      onPressed: () => _navigate(context, page),
      icon: Icon(icon, color: textColor),
      label: Text(title, style: TextStyle(color: textColor)),
      style: ElevatedButton.styleFrom(
        backgroundColor: color,
        minimumSize: Size(double.infinity, 60),
        elevation: 5,
      ),
    );
  }
}

//////////////////// TOPIC TREE ////////////////////

class TopicTreeScreen extends StatelessWidget {
  final List<Map<String, dynamic>> topics = [
    {
      'title': 'Computer Networks',
      'children': [
        {
          'title': 'Unit 1 - Basics',
          'children': [
            {'title': 'What is a Network?'},
            {'title': 'Types: LAN, WAN, MAN'},
            {'title': 'Topologies'},
            {'title': 'Network History'}
          ]
        },
        {
          'title': 'Unit 2 - OSI Model',
          'children': [
            {'title': '7 Layers Overview'},
            {'title': 'Physical layer, Data Link Layer'},
            {'title': 'Network & Transport Layer'},
            {'title': 'Session, Presentation, Application Layers'},
            {'title': 'Encapsulation'}
          ]
        },
      ]
    },
    {
      'title': 'Operating Systems',
      'children': [
        {
          'title': 'Unit 1 - Process Management',
          'children': [
            {'title': 'Threads & Scheduling'},
            {'title': 'Synchronization'}
          ]
        },
        {
          'title': 'Unit 2 - Memory Management',
          'children': [
            {'title': 'Paging'},
            {'title': 'Segmentation'}
          ]
        }
      ]
    },
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text("TopicTree ðŸŒ³")),
      body: ListView(
        padding: EdgeInsets.all(12),
        children: topics.map((t) => _buildNode(t, 0)).toList(),
      ),
    );
  }

  Widget _buildNode(Map<String, dynamic> node, int level) {
    bool hasChildren = node['children'] != null;
    return Padding(
      padding: EdgeInsets.only(left: 16.0 * level),
      child: Card(
        color: Colors.white,
        elevation: 2,
        child: ExpansionTile(
          leading: Icon(hasChildren ? Icons.folder : Icons.circle,
              color: Colors.teal.shade400, size: hasChildren ? 26 : 8),
          title: Text(node['title'],
              style: TextStyle(
                  fontWeight: FontWeight.w600,
                  color: Colors.teal.shade900,
                  fontSize: 16)),
          children: hasChildren
              ? (node['children'] as List)
                  .map((child) => _buildNode(child, level + 1))
                  .toList()
              : [],
        ),
      ),
    );
  }
}

//////////////////// FOCUS CARDS ////////////////////

class FocusCardsScreen extends StatefulWidget {
  @override
  _FocusCardsScreenState createState() => _FocusCardsScreenState();
}

class _FocusCardsScreenState extends State<FocusCardsScreen> {
  final List<Map<String, String>> cards = [
    {'q': 'What is CRM?', 'a': 'Customer Relationship Management'},
    {'q': 'Define OSI Model.', 'a': 'Seven-layer network architecture'},
    {'q': 'What is Polymorphism?', 'a': 'Different behavior with same interface'},
  ];
  int index = 0;
  bool showAnswer = false;

  void nextCard() {
    setState(() {
      index = (index + 1) % cards.length;
      showAnswer = false;
    });
  }

  @override
  Widget build(BuildContext context) {
    final card = cards[index];
    return Scaffold(
      appBar: AppBar(title: Text('FocusCards ðŸƒ')),
      body: Container(
        decoration: BoxDecoration(
          gradient: LinearGradient(
            colors: [Colors.amber.shade50, Colors.amber.shade100],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        child: Padding(
          padding: const EdgeInsets.all(16),
          child: Column(
            children: [
              Expanded(
                child: GestureDetector(
                  onTap: () => setState(() => showAnswer = !showAnswer),
                  child: AnimatedContainer(
                    duration: Duration(milliseconds: 300),
                    decoration: BoxDecoration(
                      color: Colors.white,
                      borderRadius: BorderRadius.circular(20),
                      boxShadow: [
                        BoxShadow(color: Colors.amber.shade100, blurRadius: 10)
                      ],
                    ),
                    child: Center(
                      child: Padding(
                        padding: const EdgeInsets.all(20),
                        child: Text(
                          showAnswer ? card['a']! : card['q']!,
                          textAlign: TextAlign.center,
                          style: TextStyle(
                            fontSize: 22,
                            color: Colors.amber.shade900,
                            fontWeight: FontWeight.w500,
                          ),
                        ),
                      ),
                    ),
                  ),
                ),
              ),
              SizedBox(height: 20),
              ElevatedButton.icon(
                icon: Icon(Icons.arrow_forward, color: Colors.white),
                label: Text("Next Card", style: TextStyle(color: Colors.white)),
                onPressed: nextCard,
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.amber.shade700,
                  padding: EdgeInsets.symmetric(horizontal: 32, vertical: 12),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

//////////////////// QUIZ TRAIL ////////////////////

class QuizTrailScreen extends StatefulWidget {
  @override
  _QuizTrailScreenState createState() => _QuizTrailScreenState();
}

class _QuizTrailScreenState extends State<QuizTrailScreen> {
  final List<Map<String, dynamic>> questions = [
    {
      'q': 'Which layer handles routing?',
      'options': ['Transport', 'Network', 'Session'],
      'a': 'Network'
    },
    {
      'q': 'Which SQL command creates a table?',
      'options': ['INSERT', 'CREATE', 'DELETE'],
      'a': 'CREATE'
    },
    {
      'q': 'RAM stands for?',
      'options': [
        'Random Access Memory',
        'Run All Memory',
        'Read Access Memory'
      ],
      'a': 'Random Access Memory'
    },
  ];

  int index = 0;
  int score = 0;
  bool finished = false;

  void check(String opt) {
    if (opt == questions[index]['a']) score++;
    if (index == questions.length - 1) {
      setState(() => finished = true);
    } else {
      setState(() => index++);
    }
  }

  void reset() {
    setState(() {
      index = 0;
      score = 0;
      finished = false;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('QuizTrail ðŸ§©')),
      body: Container(
        width: double.infinity,
        decoration: BoxDecoration(
          gradient: LinearGradient(
            colors: [Colors.indigo.shade50, Colors.indigo.shade100],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        child: finished ? _buildResultView() : _buildQuestionView(),
      ),
    );
  }

  Widget _buildQuestionView() {
    final currentQ = questions[index];
    return Padding(
      padding: const EdgeInsets.all(20.0),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.center,
        children: [
          Icon(Icons.quiz_rounded, size: 80, color: Colors.indigo.shade400),
          SizedBox(height: 20),
          Text(
            "Question ${index + 1} of ${questions.length}",
            style: TextStyle(
              color: Colors.indigo.shade900,
              fontWeight: FontWeight.bold,
              fontSize: 18,
            ),
          ),
          SizedBox(height: 20),
          Container(
            padding: EdgeInsets.all(16),
            decoration: BoxDecoration(
              color: Colors.white,
              borderRadius: BorderRadius.circular(12),
              boxShadow: [
                BoxShadow(color: Colors.indigo.shade100, blurRadius: 6)
              ],
            ),
            child: Text(currentQ['q'],
                style:
                    TextStyle(fontSize: 18, color: Colors.indigo.shade900)),
          ),
          SizedBox(height: 20),
          ...currentQ['options'].map<Widget>((opt) {
            return Padding(
              padding: const EdgeInsets.symmetric(vertical: 5.0),
              child: ElevatedButton(
                onPressed: () => check(opt),
                child: Text(opt, style: TextStyle(color: Colors.white)),
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.indigo.shade400,
                  minimumSize: Size(double.infinity, 48),
                  shape: StadiumBorder(),
                ),
              ),
            );
          }).toList(),
          Spacer(),
          Text(
            "Score: $score",
            style: TextStyle(
                color: Colors.indigo.shade700,
                fontWeight: FontWeight.bold,
                fontSize: 18),
          ),
          SizedBox(height: 20),
        ],
      ),
    );
  }

  Widget _buildResultView() {
    return Center(
      child: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.emoji_events,
                size: 100, color: Colors.amber.shade700),
            SizedBox(height: 20),
            Text("ðŸŽ‰ Quiz Completed!",
                style: TextStyle(
                    fontSize: 26,
                    color: Colors.indigo.shade900,
                    fontWeight: FontWeight.bold)),
            SizedBox(height: 10),
            Text("Your Score: $score / ${questions.length}",
                style: TextStyle(
                    fontSize: 20,
                    color: Colors.indigo.shade700,
                    fontWeight: FontWeight.w500)),
            SizedBox(height: 30),
            ElevatedButton.icon(
              icon: Icon(Icons.replay, color: Colors.white),
              label: Text("Play Again",
                  style: TextStyle(color: Colors.white, fontSize: 18)),
              onPressed: reset,
              style: ElevatedButton.styleFrom(
                backgroundColor: Colors.indigo.shade500,
                padding: EdgeInsets.symmetric(horizontal: 24, vertical: 12),
                shape: StadiumBorder(),
              ),
            )
          ],
        ),
      ),
    );
  }
}
